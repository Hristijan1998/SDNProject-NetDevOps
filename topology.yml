name: sdn-project

topology:
  nodes:

    controller:
      kind: linux
      image: osrg/ryu
      cmd: ryu-manager ryu.app.simple_switch_13
      network-mode: none

    s1:
      kind: linux
      image: ghcr.io/techempt/ovs:latest
      cmd: ovs-vsctl add-br br0 && sleep infinity
      network-mode: none

    s2:
      kind: linux
      image: ghcr.io/techempt/ovs:latest
      cmd: ovs-vsctl add-br br0 && sleep infinity
      network-mode: none

    s3:
      kind: linux
      image: ghcr.io/techempt/ovs:latest
      cmd: ovs-vsctl add-br br0 && sleep infinity
      network-mode: none

    s4:
      kind: linux
      image: ghcr.io/techempt/ovs:latest
      cmd: ovs-vsctl add-br br0 && sleep infinity
      network-mode: none

    pc1:
      kind: linux
      image: alpine
      cmd: sh -c "ip addr add 10.0.0.1/24 dev eth0 && ip link set eth0 up && sleep infinity"
      network-mode: none

    pc2:
      kind: linux
      image: alpine
      cmd: sh -c "ip addr add 10.0.0.2/24 dev eth0 && ip link set eth0 up && sleep infinity"
      network-mode: none

  links:
    - endpoints:
        - pc1:eth0
        - s1:eth1
    - endpoints:
        - s1:eth2
        - s2:eth1
    - endpoints:
        - s2:eth2
        - s3:eth1
    - endpoints:
        - s3:eth2
        - s4:eth1
    - endpoints:
        - s4:eth2
        - pc2:eth0

    - endpoints:
        - controller:eth1
        - s1:eth3
    - endpoints:
        - controller:eth2
        - s2:eth3
    - endpoints:
        - controller:eth3
        - s3:eth3
    - endpoints:
        - controller:eth4
        - s4:eth3
